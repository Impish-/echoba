{% extends 'base.html' %}
{% from 'macro.html' import post_message %}

{% block title %}/{{ board.dir }}/ - {{ board.name }}{% endblock %}

{% block content %}
    <div class="logo">
        <a href="/{{ board.dir }}/">/{{ board.dir }}/ - {{ board.name }}</a>
    </div>
    {% include "post_form.html" %}

    {% for thread in board.threads %}
        <div class="thread" id="thread{{ thread.id }}">
            <hr>

            <div class="postnode">
                {{ post_message(
                            message=thread.op(),
                            op_post=1,
                            op_label=1,
                            thread_link=thread.link(),
                            is_admin=current_user
                ) }}
            </div>

            <div class="replies">
                {% for message in thread.messages_tail() %}
                    {{ post_message(
                            message=message,
                            thread_link=thread.link(),
                            is_admin=current_user
                    ) }}
                {% endfor %}
            </div>
        </div>
    {% endfor %}

    <div class="thread-bottom">
        {% if is_paginated %}
            <table>
                <tr>
                    <td>
                        {% if page_obj.has_previous() %}
                            <a href="{{ reverse_url('board_page', board.dir, page_obj.previous_page_number()) }}">&larr;Назад</a>
                        {% endif %}

                        {% for page in range(1, paginator.num_pages + 1) %}
                            [
                                {% if page_obj.number != page %}
                                    <a href="{{ reverse_url('board_page', board.dir, page) }}">{{page}}</a>
                                {% else %}
                                    {{ page }}
                                {% endif %}
                            ]
                        {% endfor %}

                        {% if page_obj.has_next() %}
                             <a href="{{ reverse_url('board_page', board.dir, page_obj.next_page_number()) }}">Вперед&rarr;</a>
                        {% endif %}
                    </td>
                </tr>
            </table>
        {% endif %}
    </div>
{% endblock %}
